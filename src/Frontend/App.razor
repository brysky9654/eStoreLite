@inject CatalogService CatalogService

<html>
<head>
    <title>eShopLite</title>
    <link rel="stylesheet" href="site.css" />
</head>
<body>
    <h3>Catalog</h3>

    <div class="container">
        @if (catalog is { Data: var data })
        {
            <div class="grid">
                @foreach (var item in data)
                {
                    <div class="grid-item">
                        <div class="grid-item-content">
                            <img src="catalog/images/@item.Id" alt="@item.Name" />
                            <div class="grid-item-text">
                                <h4>@item.Name</h4>
                                <p>@item.Description</p>
                                <p>@item.Price</p>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <div class="pager">
                @if (paginationInfo.HasPreviousPage)
                {
                    <a class="previous" href="?before=@paginationInfo.FirstId">Previous</a>
                }

                @if (paginationInfo.HasNextPage)
                {
                    <a class="next" href="?after=@paginationInfo.LastId">Next</a>
                }
            </div>
        }
        else
        {
            <p>Loading...</p>
        }
    </div>
</body>
</html>

@code {
    Catalog? catalog;
    PaginationInfo paginationInfo = new(FirstId: 0, LastId: 0, HasPreviousPage: false, HasNextPage: false);

    [Parameter]
    public int? Before { get; set; }

    [Parameter]
    public int? After { get; set; }

    protected override async Task OnInitializedAsync()
    {
        catalog = await CatalogService.GetItemsAsync(Before, After);

        if (catalog is null)
        {
            return;
        }

        paginationInfo = new PaginationInfo(catalog.FirstId, catalog.NextId, catalog.FirstId > 1, !catalog.IsLastPage);
    }

    record PaginationInfo(int FirstId, int LastId, bool HasPreviousPage, bool HasNextPage);
}